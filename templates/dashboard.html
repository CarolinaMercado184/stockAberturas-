<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Dashboard de Stock</title>
</head>
<body>
    <h1>Dashboard de Stock</h1>

    <h2>Agregar nuevo stock</h2>
    <form method="POST" action="/agregar_stock">
        <input type="text" name="producto" placeholder="Producto" required>
        <input type="text" name="tipo" placeholder="Tipo (Puerta, Ventana...)" required>
        <input type="text" name="medida" placeholder="Medida" required>
        <input type="text" name="color" placeholder="Color" required>
        <input type="number" name="cantidad" placeholder="Cantidad" required>
        <select name="ubicacion" required>
            <option value="BYG">BYG</option>
            <option value="LA ECONÓMICA">LA ECONÓMICA</option>
            <option value="GALPÓN">GALPÓN</option>
        </select>
        <button type="submit">Agregar</button>
    </form>
    <hr>

    <form method="get">
        <label for="ubicacion">Filtrar por ubicación:</label>
        <select name="ubicacion" id="ubicacion" onchange="this.form.submit()">
            <option value="">Todas</option>
            <option value="BYG" {% if ubicacion_seleccionada == 'BYG' %}selected{% endif %}>BYG</option>
            <option value="LA ECONÓMICA" {% if ubicacion_seleccionada == 'LA ECONÓMICA' %}selected{% endif %}>LA ECONÓMICA</option>
            <option value="GALPÓN" {% if ubicacion_seleccionada == 'GALPÓN' %}selected{% endif %}>GALPÓN</option>
        </select>
    </form>

    {% if ubicacion_seleccionada %}
        <h2>Stock en {{ ubicacion_seleccionada }}</h2>
        <table border="1">
            <tr>
                <th>Producto</th>
                <th>Tipo</th>
                <th>Medida</th>
                <th>Color</th>
                <th>Cantidad</th>
            </tr>
            {% for item in stock_por_ubicacion %}
                <tr>
                    <td>{{ item['producto'] }}</td>
                    <td>{{ item['tipo'] }}</td>
                    <td>{{ item['medida'] }}</td>
                    <td>{{ item['color'] }}</td>
                    <td>{{ item['cantidad'] }}</td>
                </tr>
            {% endfor %}
        </table>
    {% else %}
        {% for ubicacion, items in stock_organizado.items() %}
            <h2>Stock en {{ ubicacion }}</h2>
            <table border="1">
                <tr>
                    <th>Producto</th>
                    <th>Tipo</th>
                    <th>Medida</th>
                    <th>Color</th>
                    <th>Cantidad</th>
                </tr>
                {% for item in items %}
                    <tr>
                        <td>{{ item['producto'] }}</td>
                        <td>{{ item['tipo'] }}</td>
                        <td>{{ item['medida'] }}</td>
                        <td>{{ item['color'] }}</td>
                        <td>{{ item['cantidad'] }}</td>
                    </tr>
                {% endfor %}
            </table>
        {% endfor %}
    {% endif %}
</body>
</html>
